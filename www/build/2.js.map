{"version":3,"sources":["../../src/pages/notifications/notifications.module.ts","../../node_modules/time-ago-pipe/time-ago-pipe.ts","../../src/pages/notifications/notifications.ts","../../node_modules/time-ago-pipe/index.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAAyC;AACO;AACI;AACG;AACC;AAcxD;IACE;IAAe,CAAC;IADL,uBAAuB;QAZnC,+DAAQ,CAAC;YACR,YAAY,EAAE;gBACZ,yEAAiB;aAClB;YACD,OAAO,EAAE;gBACP,sEAAe,CAAC,QAAQ,CAAC,yEAAiB,CAAC;gBAC3C,wEAAW;gBACX,8EAAiB;aAClB;YACD,OAAO,EAAC,EACP;SACF,CAAC;;OACW,uBAAuB,CAGnC;IAAD,8BAAC;CAAA;AAHmC;;;;;;;;;;;;;;;;;;;;AClBoD;AAKxF;IAEC,qBAAoB,iBAAoC,EAAU,MAAc;QAA5D,sBAAiB,GAAjB,iBAAiB,CAAmB;QAAU,WAAM,GAAN,MAAM,CAAQ;IAAG,CAAC;IACpF,+BAAS,GAAT,UAAU,KAAY;QAAtB,iBA0CC;QAzCA,IAAI,CAAC,WAAW,EAAE,CAAC;QACnB,IAAI,CAAC,GAAG,IAAI,IAAI,CAAC,KAAK,CAAC,CAAC;QACxB,IAAI,GAAG,GAAG,IAAI,IAAI,EAAE,CAAC;QACrB,IAAI,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC,OAAO,EAAE,CAAC,GAAC,IAAI,CAAC,CAAC,CAAC;QACvE,IAAI,YAAY,GAAG,IAAI,CAAC,qBAAqB,CAAC,OAAO,CAAC,GAAE,IAAI,CAAC;QAC7D,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,iBAAiB,CAAC;YAC1C,EAAE,CAAC,CAAC,OAAO,MAAM,KAAK,WAAW,CAAC,CAAC,CAAC;gBACnC,MAAM,CAAC,MAAM,CAAC,UAAU,CAAC;oBACxB,KAAI,CAAC,MAAM,CAAC,GAAG,CAAC,cAAM,YAAI,CAAC,iBAAiB,CAAC,YAAY,EAAE,EAArC,CAAqC,CAAC,CAAC;gBAC9D,CAAC,EAAE,YAAY,CAAC,CAAC;YAClB,CAAC;YACD,MAAM,CAAC,IAAI,CAAC;QACb,CAAC,CAAC,CAAC;QACH,IAAI,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,OAAO,GAAG,EAAE,CAAC,CAAC,CAAC;QACjD,IAAI,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,OAAO,GAAG,EAAE,CAAC,CAAC,CAAC;QAC/C,IAAI,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,GAAG,EAAE,CAAC,CAAC,CAAC;QAC5C,IAAI,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,GAAC,MAAM,CAAC,CAAC,CAAC;QAC/C,IAAI,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,GAAC,GAAG,CAAC,CAAC,CAAC;QAC3C,EAAE,CAAC,CAAC,OAAO,IAAI,EAAE,CAAC,CAAC,CAAC;YACnB,MAAM,CAAC,mBAAmB,CAAC;QAC5B,CAAC;QAAC,IAAI,CAAC,EAAE,CAAC,CAAC,OAAO,IAAI,EAAE,CAAC,CAAC,CAAC;YAC1B,MAAM,CAAC,cAAc,CAAC;QACvB,CAAC;QAAC,IAAI,CAAC,EAAE,CAAC,CAAC,OAAO,IAAI,EAAE,CAAC,CAAC,CAAC;YAC1B,MAAM,CAAC,OAAO,GAAG,cAAc,CAAC;QACjC,CAAC;QAAC,IAAI,CAAC,EAAE,CAAC,CAAC,OAAO,IAAI,EAAE,CAAC,CAAC,CAAC;YAC1B,MAAM,CAAC,aAAa,CAAC;QACtB,CAAC;QAAC,IAAI,CAAC,EAAE,CAAC,CAAC,KAAK,IAAI,EAAE,CAAC,CAAC,CAAC;YACxB,MAAM,CAAC,KAAK,GAAG,YAAY,CAAC;QAC7B,CAAC;QAAC,IAAI,CAAC,EAAE,CAAC,CAAC,KAAK,IAAI,EAAE,CAAC,CAAC,CAAC;YACxB,MAAM,CAAC,WAAW,CAAC;QACpB,CAAC;QAAC,IAAI,CAAC,EAAE,CAAC,CAAC,IAAI,IAAI,EAAE,CAAC,CAAC,CAAC;YACvB,MAAM,CAAC,IAAI,GAAG,WAAW,CAAC;QAC3B,CAAC;QAAC,IAAI,CAAC,EAAE,CAAC,CAAC,IAAI,IAAI,EAAE,CAAC,CAAC,CAAC;YACvB,MAAM,CAAC,aAAa,CAAC;QACtB,CAAC;QAAC,IAAI,CAAC,EAAE,CAAC,CAAC,IAAI,IAAI,GAAG,CAAC,CAAC,CAAC;YACxB,MAAM,CAAC,MAAM,GAAG,aAAa,CAAC;QAC/B,CAAC;QAAC,IAAI,CAAC,EAAE,CAAC,CAAC,IAAI,IAAI,GAAG,CAAC,CAAC,CAAC;YACxB,MAAM,CAAC,YAAY,CAAC;QACrB,CAAC;QAAC,IAAI,CAAC,CAAC;YACP,MAAM,CAAC,KAAK,GAAG,YAAY,CAAC;QAC7B,CAAC;IACF,CAAC;IACD,iCAAW,GAAX;QACC,IAAI,CAAC,WAAW,EAAE,CAAC;IACpB,CAAC;IACO,iCAAW,GAAnB;QACC,EAAE,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC;YAChB,MAAM,CAAC,YAAY,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YAChC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC;QACnB,CAAC;IACF,CAAC;IACO,2CAAqB,GAA7B,UAA8B,OAAc;QAC3C,IAAI,GAAG,GAAG,EAAE,CAAC;QACb,IAAI,EAAE,GAAG,GAAG,GAAG,EAAE,CAAC;QAClB,IAAI,GAAG,GAAG,EAAE,GAAG,EAAE,CAAC;QAClB,EAAE,CAAC,CAAC,OAAO,GAAG,GAAG,CAAC,CAAC,CAAC;YACnB,MAAM,CAAC,CAAC,CAAC;QACV,CAAC;QAAC,IAAI,CAAC,EAAE,CAAC,CAAC,OAAO,GAAG,EAAE,CAAC,CAAC,CAAC;YACzB,MAAM,CAAC,EAAE,CAAC;QACX,CAAC;QAAC,IAAI,CAAC,EAAE,CAAC,CAAC,OAAO,GAAG,GAAG,CAAC,CAAC,CAAC;YAC1B,MAAM,CAAC,GAAG,CAAC;QACZ,CAAC;QAAC,IAAI,CAAC,CAAC;YACP,MAAM,CAAC,IAAI,CAAC;QACb,CAAC;IACF,CAAC;IApEW,WAAW;QAJvB,2DAAI,CAAC;YACL,IAAI,EAAC,SAAS;YACd,IAAI,EAAC,KAAK;SACV,CAAC;yCAGsC,gEAAiB,EAAkB,qDAAM;OAFpE,WAAW,CAqEvB;IAAD,kBAAC;CAAA;AArEuB;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACLkB;AACgC;AACb;AACgB;AACY;AACxD;AACkD;AACG;AAOtF;IAEE,2BACU,SAAiC,EAClC,OAA6B,EAC7B,SAA0B,EACzB,SAA6B,EAC7B,UAA8B;QAJ9B,cAAS,GAAT,SAAS,CAAwB;QAClC,YAAO,GAAP,OAAO,CAAsB;QAC7B,cAAS,GAAT,SAAS,CAAiB;QACzB,cAAS,GAAT,SAAS,CAAoB;QAC7B,eAAU,GAAV,UAAU,CAAoB;QAEtC,IAAI,IAAI,GAAG,oCAAM,CAAC,IAAI,IAAI,EAAE,CAAC,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,MAAM,EAAE,CAAC;QACtD,IAAI,EAAE,GAAG,oCAAM,CAAC,IAAI,IAAI,EAAE,CAAC,CAAC,GAAG,CAAC,EAAE,EAAE,MAAM,CAAC,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,MAAM,EAAE,CAAC;QAClE,kFAAkF;QAClF,IAAI,CAAC,SAAS,CAAC,gBAAgB,CAAC,IAAI,EAAE,EAAE,EAAC,IAAI,CAAC,UAAU,CAAC,kBAAkB,CAAC,CAAC;IAC/E,CAAC;IAED,4CAAgB,GAAhB;QACE,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;IAC1C,CAAC;IAED,wCAAY,GAAZ,UAAa,OAAO;QAClB,IAAI,CAAC,SAAS,CAAC,iBAAiB,CAAC,OAAO,EAAE,CAAC,EAAE,UAAU,CAAC,CAAC;IAC3D,CAAC;IAED,wCAAY,GAAZ,UAAa,OAAO;QAClB,IAAI,UAAU,GAAG,cAAc,CAAC;QAChC,IAAI,QAAQ,GAAG,2CAA2C,CAAC;QAC3D,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,OAAO,EAAE,UAAU,EAAE,QAAQ,EAAE,CAAC,CAAC,CAAC;IACjE,CAAC;IAED,sCAAU,GAAV,UAAW,OAAO;QAChB,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;IACrC,CAAC;IAED,mCAAO,GAAP,UAAQ,KAAK;QACX,EAAE,CAAC,CAAC,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;YAC7B,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;QACjC,CAAC;QAAC,IAAI,CAAC,CAAC;YACN,IAAI,CAAC,YAAY,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;QACnC,CAAC;IACH,CAAC;IAED,wCAAY,GAAZ,UAAa,KAAK;QAChB,MAAM,CAAC,KAAK,CAAC,SAAS,IAAI,CAAC,KAAK,CAAC,MAAM,IAAI,CAAC,IAAI,CAAC,qBAAqB,CAAC,KAAK,CAAC,CAAC;IAChF,CAAC;IAED,iDAAqB,GAArB,UAAsB,KAAK;QACzB,MAAM,CAAC,CAAC,KAAK,CAAC,SAAS,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,IAAI,IAAI,CAAC,UAAU,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC;IAClG,CAAC;IAED,qCAAS,GAAT,UAAU,KAAU;QAClB,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;QACnB,IAAI,QAAQ,GAAG;YACb,IAAI,EAAE,KAAK,CAAC,KAAK,CAAC,IAAI;YACtB,IAAI,EAAE,KAAK,CAAC,IAAI;YAChB,EAAE,EAAE,KAAK,CAAC,EAAE;YACZ,MAAM,EAAE,KAAK,CAAC,MAAM;YACpB,QAAQ,EAAE,KAAK,CAAC,KAAK,CAAC,QAAQ;SAC/B,CAAC;QACF,IAAI,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,iFAAe,EAAE,QAAQ,CAAC,CAAC;QAC/D,OAAO,CAAC,OAAO,EAAE,CAAC;IACpB,CAAC;IA5DU,iBAAiB;QAJ7B,gEAAS,CAAC;YACT,QAAQ,EAAE,oBAAoB;WACG;SAClC,CAAC;0BAQwC;OAP7B,iBAAiB,CA6D7B;IAAD,uBAAC;;AAAA;SA7DY,iBAAiB,e;;;;;;;;;;;;;;;;;;ACdW;AACK;AAM9C;IAAA;IAAiC,CAAC;IAArB,iBAAiB;QAJ7B,+DAAQ,CAAC;YACT,YAAY,EAAE,CAAC,mEAAW,CAAC;YAC3B,OAAO,EAAE,CAAC,mEAAW,CAAC;SACtB,CAAC;OACW,iBAAiB,CAAI;IAAD,wBAAC;CAAA;AAAJ;AAEE","file":"2.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { NotificationsPage } from './notifications';\r\nimport { PipesModule } from '../../pipes/pipes.module';\r\nimport { TimeAgoPipeModule } from \"time-ago-pipe/index\";\r\n\r\n@NgModule({\r\n  declarations: [\r\n    NotificationsPage\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(NotificationsPage),\r\n    PipesModule,\r\n    TimeAgoPipeModule\r\n  ],\r\n  exports:[\r\n  ]\r\n})\r\nexport class NotificationsPageModule {\r\n  constructor() {} \r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/notifications/notifications.module.ts","import {Pipe, PipeTransform, NgZone, ChangeDetectorRef, OnDestroy} from \"@angular/core\";\r\n@Pipe({\r\n\tname:'timeAgo',\r\n\tpure:false\r\n})\r\nexport class TimeAgoPipe implements PipeTransform, OnDestroy {\r\n\tprivate timer: number;\r\n\tconstructor(private changeDetectorRef: ChangeDetectorRef, private ngZone: NgZone) {}\r\n\ttransform(value:string) {\r\n\t\tthis.removeTimer();\r\n\t\tlet d = new Date(value);\r\n\t\tlet now = new Date();\r\n\t\tlet seconds = Math.round(Math.abs((now.getTime() - d.getTime())/1000));\r\n\t\tlet timeToUpdate = this.getSecondsUntilUpdate(seconds) *1000;\r\n\t\tthis.timer = this.ngZone.runOutsideAngular(() => {\r\n\t\t\tif (typeof window !== 'undefined') {\r\n\t\t\t\treturn window.setTimeout(() => {\r\n\t\t\t\t\tthis.ngZone.run(() => this.changeDetectorRef.markForCheck());\r\n\t\t\t\t}, timeToUpdate);\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t});\r\n\t\tlet minutes = Math.round(Math.abs(seconds / 60));\r\n\t\tlet hours = Math.round(Math.abs(minutes / 60));\r\n\t\tlet days = Math.round(Math.abs(hours / 24));\r\n\t\tlet months = Math.round(Math.abs(days/30.416));\r\n\t\tlet years = Math.round(Math.abs(days/365));\r\n\t\tif (seconds <= 45) {\r\n\t\t\treturn 'a few seconds ago';\r\n\t\t} else if (seconds <= 90) {\r\n\t\t\treturn 'a minute ago';\r\n\t\t} else if (minutes <= 45) {\r\n\t\t\treturn minutes + ' minutes ago';\r\n\t\t} else if (minutes <= 90) {\r\n\t\t\treturn 'an hour ago';\r\n\t\t} else if (hours <= 22) {\r\n\t\t\treturn hours + ' hours ago';\r\n\t\t} else if (hours <= 36) {\r\n\t\t\treturn 'a day ago';\r\n\t\t} else if (days <= 25) {\r\n\t\t\treturn days + ' days ago';\r\n\t\t} else if (days <= 45) {\r\n\t\t\treturn 'a month ago';\r\n\t\t} else if (days <= 345) {\r\n\t\t\treturn months + ' months ago';\r\n\t\t} else if (days <= 545) {\r\n\t\t\treturn 'a year ago';\r\n\t\t} else { // (days > 545)\r\n\t\t\treturn years + ' years ago';\r\n\t\t}\r\n\t}\r\n\tngOnDestroy(): void {\r\n\t\tthis.removeTimer();\r\n\t}\r\n\tprivate removeTimer() {\r\n\t\tif (this.timer) {\r\n\t\t\twindow.clearTimeout(this.timer);\r\n\t\t\tthis.timer = null;\r\n\t\t}\r\n\t}\r\n\tprivate getSecondsUntilUpdate(seconds:number) {\r\n\t\tlet min = 60;\r\n\t\tlet hr = min * 60;\r\n\t\tlet day = hr * 24;\r\n\t\tif (seconds < min) { // less than 1 min, update ever 2 secs\r\n\t\t\treturn 2;\r\n\t\t} else if (seconds < hr) { // less than an hour, update every 30 secs\r\n\t\t\treturn 30;\r\n\t\t} else if (seconds < day) { // less then a day, update every 5 mins\r\n\t\t\treturn 300;\r\n\t\t} else { // update every hour\r\n\t\t\treturn 3600;\r\n\t\t}\r\n\t}\r\n}\n\n\n// WEBPACK FOOTER //\n// ./node_modules/time-ago-pipe/time-ago-pipe.ts","import { Component } from '@angular/core';\r\nimport { IonicPage, NavController, NavParams, ModalController } from 'ionic-angular';\r\nimport { DetailsviewPage } from '../detailsview/detailsview';\r\nimport { AppContextProvider } from '../../providers/app-context/app-context';\r\nimport { LeaveServicev2Provider } from '../../providers/leave-servicev2/leave-servicev2';\r\nimport * as moment from 'moment';\r\nimport { ToastMessageProvider } from '../../providers/toast-message/toast-message';\r\nimport { commentsController } from '../../components/controllers/comments-controller';\r\n\r\n@IonicPage()\r\n@Component({\r\n  selector: 'page-notifications',\r\n  templateUrl: 'notifications.html',\r\n})\r\nexport class NotificationsPage {\r\n\r\n  constructor(\r\n    private leavesSvc: LeaveServicev2Provider,\r\n    public toastMP: ToastMessageProvider,\r\n    public modalCtrl: ModalController,\r\n    private alertCtrl: commentsController,\r\n    private appContext: AppContextProvider) {\r\n\r\n    var from = moment(new Date()).startOf('day').toDate();\r\n    var to = moment(new Date()).add(90, 'days').endOf('day').toDate();\r\n    //this.leavesSvc.searchLeavesByDateRange(from, to,this.appContext.searchedLeaves);\r\n    this.leavesSvc.getNotifications(from, to,this.appContext.notificationLeaves);\r\n  }\r\n\r\n  ionViewWillLeave() {\r\n    this.appContext.searchedLeaves.next([]);\r\n  }\r\n\r\n  approveLeave(leaveId) {\r\n    this.leavesSvc.updateLeaveStatus(leaveId, 1, \"Approved\");\r\n  }\r\n\r\n  declineLeave(leaveId) {\r\n    let Modaltitle = \"Reject Leave\";\r\n    let Modalmsg = \"Do you wish to reject this leave request?\";\r\n    this.alertCtrl.presentPrompt(leaveId, Modaltitle, Modalmsg, 2);\r\n  }\r\n\r\n  markAsRead(leaveId) {\r\n    this.leavesSvc.markAsRead(leaveId);\r\n  }\r\n\r\n  onSwipe(leave) {\r\n    if (this.canShowClear(leave)) {\r\n      this.markAsRead(leave.leaveId);\r\n    } else {\r\n      this.approveLeave(leave.leaveId);\r\n    }\r\n  }\r\n\r\n  canShowClear(leave) {\r\n    return leave.isMyLeave && !leave.isRead && !this.canShowApproveDecline(leave);\r\n  }\r\n\r\n  canShowApproveDecline(leave) {\r\n    return !leave.isMyLeave && (leave.owner.manager.email == this.appContext.myProfileObject.email);\r\n  }\r\n\r\n  openModal(leave: any) {\r\n    console.log(leave);\r\n    let leaveObj = {\r\n      name: leave.owner.name,\r\n      from: leave.from,\r\n      to: leave.to,\r\n      reason: leave.reason,\r\n      photoUrl: leave.owner.photoUrl\r\n    };\r\n    let myModal = this.modalCtrl.create(DetailsviewPage, leaveObj);\r\n    myModal.present();\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/notifications/notifications.ts","import { NgModule } from '@angular/core';\r\nimport { TimeAgoPipe } from './time-ago-pipe';\r\n\r\n@NgModule({\r\n\tdeclarations: [TimeAgoPipe],\r\n\texports: [TimeAgoPipe],\r\n})\r\nexport class TimeAgoPipeModule { }\r\n\r\nexport * from './time-ago-pipe';\r\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/time-ago-pipe/index.ts"],"sourceRoot":""}